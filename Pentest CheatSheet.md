# Pentest CheatSheet
Tags: #References #RTO #Cheatsheet \
Links:

These are useful commands that I found to be very effective during my pentests and CTFs. Please customize any command as needed for your scenario!

---

## Reconnaissance

### Port Scanning and Service Enumeration
'Default' TCP Nmap scan \
`nmap -sV -A -p- <ip>` 

-> 'Default' UDP Nmap scan\
`nmap -sV -sU -F <ip>`

### Web Fuzzing & Directory Busting Enumeration
FFUF directory fuzzing (with proxychains) \
`proxychains -q ffuf -c -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u https://someurl.com/FUZZ` 

GoBuster Usage (with proxychains) \
`proxychains -q gobuster dir --url https://someurl.com --wordlist /path/to/wordlist`

### Subdomain Enumeration
Basic Amass Usage \
`amass enum -d <domain>`

Basic Subfinder Usage \
`subfinder -d <domain>`

FFUF Subdomain Enumeration \
`ffuf -c -w /usr/share/wordlists/amass/subdomains-top1mil-110000.txt -u https://FUZZ.someurl.com`

## Initial Access

### Reverse Shell
Netcat Reverse Shell Listener \
`nc -nvlp 1234`

[Reverse Shell List](https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet)

[Privilege Escalation + more](https://gtfobins.github.io/)

### Interactive Shell Spawner (to break free from a restrictive shell)
Python
```
python -c 'import pty;pty.spawn("/bin/sh")'		# try with /bin/bash
python -c 'import os; os.system("/bin/bash")'		# try with /bin/sh
```

### Linux Enumeration
SUID Enumeration
```
find / -user root -perm -4000 -print 2>/dev/null
find / -perm -u=s -type f 2>/dev/null
find / -user root -perm -4000 -exec ls -ldb {} \; 2>/dev/null
find / -perm +6000 2>/dev/null | grep '/bin/'
```

Show linux services and ports \
`netstat -punta` 

Show all services \
`systemctl`

Capabilities Enumeration \
`getcap -r / 2>/dev/null`

**User Enumeration**
```
List usernames: 
	awk -F: '{ print $1}' /etc/passwd
	cut -d: -f1 /etc/passwd

List normal users: 
	getent passwd{1000..60000}

List everything:
	cat /etc/passwd
	
```

Sudo Privileges \
`sudo -l`

User Count \
`getent passwd | wc -l`

System Enumeration \
`cat /etc/os-release`

## Useful Metasploit Modules (Misc)
```
Reverse Shell Handler
	exploit/multi/handler

Reverse Shell
	windows/meterpreter/reverse_tcp

Post Exploitation
	post/multi/recon/local_exploit_suggester
	post/windows/gather/checkvm
	post/windows/manage/enable_rdp
	
	Persistence & Backdoor
	exploit/linux/local/cron_persistence
	exploit/windows/local/persistence

Login & Bruteforcer
	auxiliary/scanner/ssh/ssh_login
	auxiliary/scanner/ftp/ftp_login 
```

## Useful Meterpreter Modules
```
Meterpreter Backdoor Service
	run metsvc (to catch this backdoor, one must use PAYLOAD windows/metsvc_bind_tcp at the handler)

Persistent Backdoor
	run persistence -h
```

## Search Exploits in "Searchsploit"

To update the DB:
```
searchsploit -u
```

To search:
```
searchsploit <string>
```
