# Pentest CheatSheet
Tags: #References #RTO #Cheatsheet #Learning \
Links:

This are the common useful commands that I found to be very effective during my pentests and CTFs

## Reconnaissance
**Basic Nmap service scan** \
`nmap -sV -A -O <ip>` \
`nmap -sV -O --script=vuln <ip>` \
`nmap -sV -O <ip>`

### Web Fuzzing & Subdomain/Directory Enumeration
**FFUF directory fuzzing** \
`proxychains -q ffuf -c -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u https://someurl.com/FUZZ` 

**GoBuster Usage** \
`proxychains -q gobuster dir --url https://someurl.com --wordlist /path/to/wordlist`

## Initial Access

### Reverse Shell
**Netcat Reverse Shell Listener** \
`nc -nvlp 1234`

**Reverse Shell List** \
https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet

**Privilege Escalation + more** \
https://gtfobins.github.io/

### Interactive Shell Spawner
**Python**
```
python -c 'import pty;pty.spawn("/bin/sh")'		# or /bin/bash
python -c 'import os; os.system("/bin/bash")'		# or /bin/sh
```

### Linux Enumeration
**SUID Enumeration**
```
find / -user root -perm -4000 -print 2>/dev/null
find / -perm -u=s -type f 2>/dev/null
find / -user root -perm -4000 -exec ls -ldb {} \; 2>/dev/null
find / -perm +6000 2>/dev/null | grep '/bin/'
```

Linux Services and ports: `netstat -punta`
All Services: `systemctl`

**Capabilities Enumeration** \
`getcap -r / 2>/dev/null`

**User Enumeration**
```
List usernames: 
	awk -F: '{ print $1}' /etc/passwd
	cut -d: -f1 /etc/passwd

List normal users: 
	getent passwd{1000..60000}

List everything:
	cat /etc/passwd
	
```

**Sudo Privileges** \
`sudo -l`

**User Count** \
`getent passwd | wc -l`

**System Enumeration** \
`cat /etc/os-release`

## Useful Metasploit Modules
```
Reverse Shell Handler
	exploit/multi/handler

Reverse Shell
	windows/meterpreter/reverse_tcp

Post Exploitation
	post/multi/recon/local_exploit_suggester
	post/windows/gather/checkvm
	post/windows/manage/enable_rdp
	
	Persistence & Backdoor
	exploit/linux/local/cron_persistence
	exploit/windows/local/persistence

Login & Bruteforcer
	auxiliary/scanner/ssh/ssh_login
	auxiliary/scanner/ftp/ftp_login 
```

## Useful Meterpreter Modules
```
Meterpreter Backdoor Service
	run metsvc (to catch this backdoor, one must use PAYLOAD windows/metsvc_bind_tcp at the handler)

Persistent Backdoor
	run persistence -h
```

## Search Exploits in "Searchsploit"

To update the DB:
```
searchsploit -u
```

To search:
```
searchsploit <string>
```
